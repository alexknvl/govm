# 签名

## 目录

1. [简介](#简介)
1. [签名算法](#签名算法)
1. [基于身份的签名方案](#基于身份的签名方案)

## 简介

数字签名算法（DSA）在联邦信息处理标准FIPS中有详细论述，称为数字签名标准。它的安全性基于素域上的离散对数问题。椭圆曲线密码（ECC）由Neal Koblitz和Victor Miller于1985年发明。它可以看作是椭圆曲线对先前基于离散对数问题（DLP）的密码系统的模拟，只是群元素由素域中的元素数换为有限域上的椭圆曲线上的点。椭圆曲线密码体制的安全性基于椭圆曲线离散对数问题（ECDLP）的难解性。椭圆曲线离散对数问题远难于离散对数问题，椭圆曲线密码系统的单位比特强度要远高于传统的离散对数系统。

## 签名算法

ECDSA是椭圆曲线对DSA的模拟。ECDSA首先由Scott和Vanstone在1992年为了响应NIST对数字签名标准（DSS）的要求而提出。ECDSA于1998年作为ISO标准被采纳，在1999年作为ANSI标准被采纳，并于2000年成为IEEE和FIPS标准。包含它的其他一些标准亦在ISO的考虑之中。

## 基于身份的签名方案

1. 如果一个私钥频繁的签名，那么被破解的可能性将越来越大
2. 如果私钥被破解，那么损失可能是巨大的

### 防止过度签名导致私钥泄露的方法

1. 频繁更换私钥/公钥（空间维度变换）

* 缺点是公钥经常变换，导致记录信息的不可继承性（交易记录，信用信息等）
* 无法作为一个大型企业的对外接口，每次更换公钥，都会对业务有一定的损失
* 在区块链app中，由于信息的不可继承性，所以更换公钥将是致命的

1. 基于身份的签名方案（时间维度变换）

* 前向安全是指私钥泄露，不会对历史签名产生危害
* 后向安全是指私钥泄露，不会对将来的签名产生危害
* 作为govm的用户，如果公钥要长时间存在，必须满足前向安全和后向安全才可以

1. 方案

* 私钥分离：父子私钥
* 父私钥对应的公钥地址，将作为对外的公钥地址
* 子私钥作为消息的签名私钥
* 签名组成：由2个签名组成，签名1为子私钥的身份证明（证明自己属于父私钥），签名2为消息的签名
* 签名信息携带时间戳，一个私钥只有在指定时间段里的签名才有效
* 身份证明：内容为父公钥地址+子公钥+时间段，签名1为父私钥对该内容进行签名（相当于代理的授权，由子私钥代替自己进行消息签名）
* 由于子私钥可以任意生成，且其有效期仅仅在指定的时间段里，所以即使子私钥泄露，影响也仅仅在指定时间段里
* 父私钥：由于只负责生成子私钥，签名的次数有限，难以通过有限的签名破解父私钥
* 使用公钥恢复算法：如果使用公钥恢复算法，那么身份证明的内容可以作为约定内容，在签名信息中不用携带

1. 基于身份的签名验证步骤：

* 签名信息：签名1+签名2
* 签名1：身份信息的签名，由父密钥生成。对应于子密钥
* 签名2：子密钥对交易信息的签名
* 通过签名2和交易信息，恢复子公钥（规定交易信息的前8个字节表示时间）
* 创建消息，消息=父公钥地址+子公钥+时间段（交易信息的时间/时间周期）
* 通过上面创建的消息和签名1，恢复父公钥
* 验证父公钥的地址是否匹配，如果匹配，则验证通过；否则验证失败
